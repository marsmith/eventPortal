webpackJsonp([0],[function(e,t,o){(function(e,t,o){function a(t){var o=[];e.each(e("#stateFilterSelect").find("option:selected"),function(t,a){o.push(e(a).val())}),console.log("in updatequery",o),g(o=o.join(","),bounds=null)}function n(t){if("dropdown"===e(t).val())N.off("moveend"),e("#stateFilterSelect").attr("disabled")&&e("#stateFilterSelect").removeAttr("disabled"),a(event);else{delete A.states;var o=N.getBounds();g(states=null,o=o),N.on("moveend",function(e){g(states=null,o=o)}),e("#stateFilterSelect").attr("disabled","disabled")}}function i(t){e.each(t,function(t,o){e("#stateFilterSelect").append(e("<option></option>").attr("value",o.RegionID).text(o.Name))}),e("#stateFilterSelect").selectpicker("val",k.split(",")),r()}function r(){e(".selectpicker").each(function(t){var o=e(this).attr("id"),a=e("#"+o+" option").get();a.sort(function(t,o){var a=e(t).text(),n=e(o).text();return a<n?-1:a>n?1:0});var n=e("#"+o);e.each(a,function(e,t){n.append(t)})}),e(".selectpicker").selectpicker("refresh")}function s(){e.getJSON(C,function(e){y=e})}function l(e){for(key in y)if(key===e)return y[key];return!1}function d(){console.log("here"),B=t.dynamicMapLayer({url:"https://idpgis.ncep.noaa.gov/arcgis/rest/services/NWS_Observations/radar_base_reflectivity/MapServer"})}function c(t){var o="sw",a="00060,72019,62619",n="P7D",i=t.target.feature.properties.SiteNumber,r=l(i);console.log("HERE",i,r),e.getJSON("https://staging.waterservices.usgs.gov/nwis/iv/?format=nwjson&sites="+i+"&parameterCd="+a+"&period="+n,function(t){if(!t.data||t.data[0].time_series_data.length<=0)return void console.log("Found an NWIS site, but it had no data in waterservices: ",i);var a=[],n="Discharge, cfs",s="Discharge: {point.y} cfs";"gw"===o&&(n="Elevation, ft",s="Elevation: {point.y} ft");var l={tooltip:{pointFormat:s},showInLegend:!1,data:t.data[0].time_series_data};if(a.push(l),r){console.log("Found AHPS site: ",r,"  Querying AHPS...");var d="https://water.weather.gov/ahps2/hydrograph_to_xml.php?gage="+r+"&output=xml",c='select * from xml where url="'+d+'"';e.ajax({url:"https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(c),dataType:"xml",success:function(t){var o=[];if(e(t).find("forecast").find("datum").each(function(){var t=e(this).find("valid").text(),a=e(this).find("secondary").attr("units"),n=parseFloat(e(this).find("secondary").text());"kcfs"===a&&(n*=1e3);var i=new Date(t)/1;o.push([i,n])}),o.sort(),o.length<=1)console.log("Found an AHPS Site, but no AHPS data was found: ",i,r);else{var l={tooltip:{pointFormat:s},showInLegend:!0,color:"#009933",name:"NWS River Forecast (AHPS)",data:o};a.push(l)}u(a,n)}})}else console.log("Did not find AHPS site for USGS Site: ",i),u(a,n)})}function u(t,a){e("#graphContainer").show(),o.setOptions({global:{useUTC:!1},lang:{thousandsSep:","}}),o.chart("graphContainer",{chart:{type:"line",spacingTop:20,spacingLeft:0,spacingBottom:0},title:{text:""},credits:{enabled:!1},xAxis:{type:"datetime",labels:{formatter:function(){return o.dateFormat("%m/%d",this.value)},align:"center",tickInterval:1728e5}},yAxis:{title:{text:a}},series:t})}function g(t,o){console.log("in loadsites",t,o),R.clearLayers(),o?(A.minLongitude=o.getWest(),A.maxLongitude=o.getEast(),A.minLatitude=o.getSouth(),A.maxLatitude=o.getNorth()):t&&(A.states=t),console.log("jere",A);var a='<h6>{SiteNumber} {SiteName}</h6><table class="table table-condensed"><tr><td>Current Condition</td><td>{FlowClassification}</td></tr><tr><td>Streamflow(cfs)</td><td>{FlowValue}</td></tr><tr><td>Time of Measurement</td><td>{FlowTime}</td></tr><tr><td>Streamflow(cfs)</td><td>{FlowValue}</td></tr><tr><td>Measurement age(minutes</td><td>{FlowAgeMinutes}</td></tr><tr><td>Rate of change (cfs/sec/hr)</td><td>{FlowRateOfChange}</td></tr><tr><td>Rate of change computation interval(minutes)</td><td>{FlowRateOfChangeMinutes}</td></tr><tr><td>Streamflow percentile relative to historical flow for this day-of-month</td><td>{FlowCurrentPtile}</td></tr></table><div id="graphContainer" style="width:100%; height:200px;display:none;"></div>';e.ajax({url:F,data:A,dataType:"json",success:function(e){console.log(e),R=L.geoJSON(e,{onEachFeature:function(e,t){var o=L.Util.template(a,e.properties);t.bindPopup(o,{minWidth:300,maxHeight:300}),t.on({click:function(e){console.log("point clicked",e.target.feature.properties.FlowCurrentPtile,e.target.feature.properties),c(e)}})},pointToLayer:function(e,t){if("N/A"!==e.properties.FlowCurrentPtile){var o={iconSize:[16,26],color:"#00ff00",circleText:"&#9650;",fontSize:12,circleRatio:0,fillOpacity:.7};return 0===e.properties.FlowCurrentPtile&&(o.color="#f20400"),e.properties.FlowCurrentPtile<.1&&(o.color="#c31725"),e.properties.FlowCurrentPtile>=.1&&e.properties.FlowCurrentPtile<=.24&&(o.color="#ff9e0c"),e.properties.FlowCurrentPtile>=.25&&e.properties.FlowCurrentPtile<=.75&&(o.color="#00ff00"),e.properties.FlowCurrentPtile>=.76&&e.properties.FlowCurrentPtile<=.9&&(o.color="#3bdedb"),e.properties.FlowCurrentPtile>=.9&&e.properties.FlowCurrentPtile<1&&(o.color="#0000fd"),"100.0"===e.properties.FlowCurrentPtile&&(o.color="#010000"),new L.Marker.SVGMarker(t,{iconOptions:o})}}}).addTo(N)}})}function m(e){switch(e){case"Streets":e="Streets";break;case"Satellite":e="Imagery";break;case"Topo":e="Topographic";break;case"Terrain":e="Terrain";break;case"Gray":e="Gray";break;case"NatGeo":e="NationalGeographic"}D&&N.removeLayer(D),D=t.basemapLayer(e),N.addLayer(D),I&&N.removeLayer(I),"Gray"!==e&&"Imagery"!==e&&"Terrain"!==e||(I=t.basemapLayer(e+"Labels"),N.addLayer(I))}function p(t){e("#NWSlegend").empty(),e("#radarTimeStamp").empty(),f(),"ridge_radar_layer"==t&&(console.log("here1"),N.addLayer(B),e("#NWSlegend").append('<img id="LegendImg" src="https://radar.weather.gov/ridge/kml/radarkeyimages/ENX_NCR_Legend_0.gif"/>'))}function f(){e("#NWSlegend").empty(),e("#radarTimeStamp").empty(),N.removeLayer(B)}function h(){e("#centerSelect").val(e("#centerSelect option:first-child").val()),e("#tripSelect").find("option:gt(0)").remove(),e("#togglePeople").hasClass("btn-primary")&&togglePeople(),"Show Go2"==e("#toggleGo2").text()&&toggleGo2(),v.clearLayers(),hullLayer.clearLayers(),f(),e(".radarBtn").removeClass("active"),N.setView([w,S],7)}var N,I,D,v,R,B,y,S="-76.2",w="42.7",b=7,C="./noaaSites.json",k="NY",F="https://txpub.usgs.gov/DSS/CWIS/1.0/services/request.ashx/getData",A={service:"flow",states:k,format:"geojson"},T=[{RegionID:"AK",Name:"Alaska",Bounds:[[51.583032,-178.217598],[71.406235,-129.992235]]},{RegionID:"AL",Name:"Alabama",Bounds:[[30.233604,-88.472952],[35.016033,-84.894016]]},{RegionID:"AR",Name:"Arkansas",Bounds:[[33.010151,-94.617257],[36.492811,-89.645479]]},{RegionID:"AS",Name:"American Samoa",Bounds:[[-14.375555,-170.82611],[-14.166389,-169.438323]]},{RegionID:"AZ",Name:"Arizona",Bounds:[[31.335634,-114.821761],[37.003926,-109.045615]]},{RegionID:"CA",Name:"California",Bounds:[[32.535781,-124.392638],[42.002191,-114.12523]]},{RegionID:"CO",Name:"Colorado",Bounds:[[36.988994,-109.055861],[41.003375,-102.037207]]},{RegionID:"CT",Name:"Connecticut",Bounds:[[40.998392,-73.725237],[42.047428,-71.788249]]},{RegionID:"DE",Name:"Delaware",Bounds:[[38.449602,-75.791094],[39.840119,-75.045623]]},{RegionID:"MD",Name:"District of Columbia",Bounds:[[37.970255,-79.489865],[39.725461,-75.045623]]},{RegionID:"FL",Name:"Florida",Bounds:[[24.956376,-87.625711],[31.003157,-80.050911]]},{RegionID:"GA",Name:"Georgia",Bounds:[[30.361291,-85.60896],[35.000366,-80.894753]]},{RegionID:"GU",Name:"Guam",Bounds:[[13.234996,144.634155],[13.65361,144.953308]]},{RegionID:"HI",Name:"Hawaii",Bounds:[[18.921786,-160.242406],[22.22912,-154.791096]]},{RegionID:"IA",Name:"Iowa",Bounds:[[40.371946,-96.640709],[43.501457,-90.142796]]},{RegionID:"ID",Name:"Idaho",Bounds:[[41.994599,-117.236921],[48.99995,-111.046771]]},{RegionID:"IL",Name:"Illinois",Bounds:[[36.986822,-91.516284],[42.509363,-87.507909]]},{RegionID:"IN",Name:"Indiana",Bounds:[[37.776224,-88.10149],[41.76554,-84.787446]]},{RegionID:"KS",Name:"Kansas",Bounds:[[36.988875,-102.051535],[40.002987,-94.601224]]},{RegionID:"KY",Name:"Kentucky",Bounds:[[36.49657,-89.568231],[39.142063,-81.959575]]},{RegionID:"LA",Name:"Louisiana",Bounds:[[28.939655,-94.041785],[33.023422,-89.021803]]},{RegionID:"MA",Name:"Massachusetts",Bounds:[[41.238279,-73.49884],[42.886877,-69.91778]]},{RegionID:"MD",Name:"Maryland",Bounds:[[37.970255,-79.489865],[39.725461,-75.045623]]},{RegionID:"ME",Name:"Maine",Bounds:[[43.09105,-71.087509],[47.453334,-66.969271]]},{RegionID:"MI",Name:"Michigan",Bounds:[[41.697494,-90.4082],[48.173795,-82.419836]]},{RegionID:"MN",Name:"Minnesota",Bounds:[[43.498102,-97.229436],[49.37173,-89.530673]]},{RegionID:"MO",Name:"Missouri",Bounds:[[35.989656,-95.767479],[40.609784,-89.105034]]},{RegionID:"MS",Name:"Mississippi",Bounds:[[30.194935,-91.643682],[35.005041,-88.090468]]},{RegionID:"MT",Name:"Montana",Bounds:[[44.353639,-116.063531],[49.000026,-104.043072]]},{RegionID:"NC",Name:"North Carolina",Bounds:[[33.882164,-84.323773],[36.589767,-75.45658]]},{RegionID:"ND",Name:"North Dakota",Bounds:[[45.930822,-104.062991],[49.000026,-96.551931]]},{RegionID:"NE",Name:"Nebraska",Bounds:[[39.992595,-104.056219],[43.003062,-95.308697]]},{RegionID:"NH",Name:"New Hampshire",Bounds:[[42.698603,-72.553428],[45.301469,-70.734139]]},{RegionID:"NJ",Name:"New Jersey",Bounds:[[38.956682,-75.570234],[41.350573,-73.896148]]},{RegionID:"NM",Name:"New Mexico",Bounds:[[31.343453,-109.051346],[36.99976,-102.997401]]},{RegionID:"NV",Name:"Nevada",Bounds:[[34.998914,-119.996324],[41.996637,-114.037392]]},{RegionID:"NY",Name:"New York",Bounds:[[40.506003,-79.763235],[45.006138,-71.869986]]},{RegionID:"OH",Name:"Ohio",Bounds:[[38.400511,-84.81207],[41.986872,-80.519996]]},{RegionID:"OK",Name:"Oklahoma",Bounds:[[33.621136,-102.997709],[37.001478,-94.428552]]},{RegionID:"OR",Name:"Oregon",Bounds:[[41.987672,-124.559617],[46.236091,-116.470418]]},{RegionID:"PA",Name:"Pennsylvania",Bounds:[[39.719313,-80.526045],[42.267327,-74.700062]]},{RegionID:"PR",Name:"Puerto Rico",Bounds:[[17.922222,-67.938339],[18.519443,-65.241958]]},{RegionID:"RI",Name:"Rhode Island",Bounds:[[41.322769,-71.866678],[42.013713,-71.117132]]},{RegionID:"SC",Name:"South Carolina",Bounds:[[32.068173,-83.350685],[35.208356,-78.579453]]},{RegionID:"SD",Name:"South Dakota",Bounds:[[42.488459,-104.061036],[45.943547,-96.439394]]},{RegionID:"TN",Name:"Tennessee",Bounds:[[34.988759,-90.305448],[36.679683,-81.652272]]},{RegionID:"TX",Name:"Texas",Bounds:[[25.845557,-106.650062],[36.493912,-93.507389]]},{RegionID:"UT",Name:"Utah",Bounds:[[36.991746,-114.047273],[42.0023,-109.043206]]},{RegionID:"VA",Name:"Virginia",Bounds:[[36.541623,-83.675177],[39.456998,-75.242219]]},{RegionID:"VT",Name:"Vermont",Bounds:[[42.725852,-73.436],[45.013351,-71.505372]]},{RegionID:"VI",Name:"Virgin Islands",Bounds:[[17.676666,-65.026947],[18.377777,-64.560287]]},{RegionID:"WA",Name:"Washington",Bounds:[[45.543092,-124.732769],[48.999931,-116.919132]]},{RegionID:"WI",Name:"Wisconsin",Bounds:[[42.489152,-92.885397],[46.952479,-86.967712]]},{RegionID:"WV",Name:"West Virginia",Bounds:[[37.20491,-82.647158],[40.637203,-77.727467]]},{RegionID:"WY",Name:"Wyoming",Bounds:[[40.994289,-111.053428],[45.002793,-104.051705]]}];e(document).ready(function(){console.log("Application Information: production version 1.0.0"),e("#appVersion").html("Application Information: production version 1.0.0"),N=L.map("mapDiv",{zoomControl:!1}),L.control.zoom({position:"topright"}).addTo(N),L.control.scale().addTo(N),D=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ",maxZoom:16}).addTo(N),N.setView([w,S],b),v=L.featureGroup().addTo(N),R=L.featureGroup().addTo(N),s(),g(states=k,bounds=null),i(T),d(),e(".basemapBtn").click(function(){e(".basemapBtn").removeClass("slick-btn-selection"),e(this).addClass("slick-btn-selection");var t=this.id.replace("btn","");m(t)}),e("#mobile-main-menu").click(function(){e("body").toggleClass("isOpenMenu")}),e(".radarBtn").click(function(){if(e(this).hasClass("slick-btn-selection"))e(this).removeClass("slick-btn-selection"),f();else{e(".radarBtn").removeClass("slick-btn-selection"),e(this).addClass("slick-btn-selection");var t=e(this).val();p(t)}}),e("#resetView").click(function(){h()}),e("#aboutButton").click(function(){e("#aboutModal").modal("show")}),e("input[type=radio][name=queryRadio]").change(function(){n(this)}),e("#stateFilterSelect").on("changed.bs.select",function(){a()})})}).call(t,o(1),o(2),o(4))}]);